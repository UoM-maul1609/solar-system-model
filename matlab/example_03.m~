% open file
nc=netcdf('/tmp/output.nc');

% Fourier analysis of the sun-planet distance for all the planets
figure
len1=length(nc{'time'}(:));
NFFT=len1;
try1=[0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1];
i=1;
indices=2435-1000+1:2435;
while NFFT>=len1
    L=fix(try1(i).*length(nc{'time'}(indices)));
    NFFT=2^nextpow2(L);
    i=i+1;
end
Fs=1./abs((nc{'time'}(2)-nc{'time'}(1))./365.25./86400);
f = Fs/2*linspace(0,1,NFFT/2+1); 

% bodies={'Sun','Mercury','Venus','Earth','Mars','Jupiter','Saturn','Uranus','Neptune','Pluto'};
bodies={'Sun','Jupiter','Saturn','Uranus','Neptune','Pluto','2010 GB-174',...
    '2004 VN-112', '2000 CR-105', '2005 RH-52', '2003 HB-57', '2007 TG-422', ...
     '2002 GB-32', '2007 VJ-305', '2010 VZ-98', '2001 FP-185', '2012 VP-113','Sedna'};

for i=2:length(bodies)
    subplot(5,4,i-1);
    
    Y=fft(sqrt(sum(squeeze(nc{'pos'}(indices,i,:)).^2,2))  ,NFFT)/L;

    plot(1./f,(2*abs(Y(1:NFFT/2+1))),'r')
    set(gca,'yscale','log','xscale','log')
    xlabel('Period (years)');ylabel('Power');
    text(0.1,0.9,bodies{i},'fontsize',15,'units','normalized');
end

% close file
close(nc);
